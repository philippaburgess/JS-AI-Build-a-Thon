// Parameters
param webapiName string = 'webapi'
param webappName string = 'webapp'
param appServicePlanName string = 'appserviceplan'

// Create an App Service Plan for webapi
module serverfarm 'br/public:avm/res/web/serverfarm:0.4.1' = {
  name: 'appserviceplan'
  scope: resourceGroup
  params: {
    name: appServicePlanName
    skuName: 'B1'
  }
}

// Create Static Web App for frontend
module webapp 'br/public:avm/res/web/static-site:0.7.0' = {
  name: 'webapp'
  scope: resourceGroup
  params: {
    name: webappName
    location: resourceGroup().location
    sku: 'Standard'
    tags: {
      'azd-service-name': webappName
    }
  }
}

// Create Web API App Service
module webapi 'br/public:avm/res/web/site:0.15.1' = {
  name: 'webapi'
  scope: resourceGroup
  params: {
    kind: 'app'
    name: webapiName
    serverFarmResourceId: serverfarm.outputs.resourceId
    tags: {
      'azd-service-name': webapiName
    }
  }
}

// Outputs
output WEBAPI_URL string = webapi.outputs.defaultHostname
output WEBAPP_URL string = webapp.outputs.defaultHostname
